define(["jquery","DoughBaseComponent","eventsWithPromises"],function(t,s,i){"use strict";function e(i,e){return this.selectors=n,s.call(this,i,e),this.$trigger=this.$el,this.$target=t('[data-dough-collapsable-target="'+this.$trigger.attr("data-dough-collapsable-trigger")+'"]'),this.i18nStrings=e&&e.i18nStrings?e.i18nStrings:o,this._setupAccessibility(),this.$trigger=this.$trigger.find("button"),e&&e.forceTo&&this.toggle(e.forceTo),this}var a,n={activeClass:"is-active",inactiveClass:"is-inactive",iconClassOpen:"icon--down-chevron-blue",iconClassClose:"icon--up-chevron-blue"},o={open:"Show",close:"Hide"};return s.extend(e),a=e.prototype,a._setupAccessibility=function(){var t="data-dough-collapsable-target-"+this.$target.attr("data-dough-collapsable-target");this.$trigger.wrapInner('<button class="unstyled-button" type="button"/>'),this.$trigger.find("button").prepend('<span data-dough-collapsable-icon class="collapsable__trigger-icon icon '+n.iconClassOpen+'"></span> <span class="visually-hidden" data-dough-collapsable-label>'+this.i18nStrings.open+"</span>").attr("aria-controls",t).attr("aria-expanded","false"),this.$target.attr("id",t)},a.init=function(t){return this.isShown=!!this.$target.hasClass(this.selectors.activeClass),this.setListeners(!0),this._initialisedSuccess(t),this},a.setListeners=function(s){return this.$trigger[s?"on":" off"]("click",t.proxy(function(t){this.toggle(),t.preventDefault()},this)),this},a.toggle=function(t){var s,e,a,o;return s="undefined"!=typeof t?"show"===t?"addClass":"removeClass":this.isShown?"removeClass":"addClass",this.isShown=!!this.$target[s](n.activeClass).hasClass(n.activeClass),this.$trigger[s](n.activeClass),this.isShown===!0?(e=this.i18nStrings.close,a="true",o=n.iconClassClose,this.$target.attr("tabindex",0).focus()):(e=this.i18nStrings.open,a="false",o=n.iconClassOpen),this.$trigger.find("[data-dough-collapsable-label]").text(e),this.$trigger.attr("aria-expanded",a),this.$trigger.find("[data-dough-collapsable-icon]").removeClass(n.iconClassOpen+" "+n.iconClassClose).addClass(o),"undefined"==typeof t&&i.publish("toggler:toggled",{emitter:this,visible:this.isShown}),this},e});