!function(e){var t=0,n=function(){return(new Date).getTime()+t++},a=function(e){return"["+e+"]$1"},i=function(e){return"_"+e+"_$1"};e(document).on("click",".add_fields",function(t){t.preventDefault();var o=e(this),r=o.data("association"),s=o.data("associations"),c=o.data("association-insertion-template"),d=o.data("association-insertion-method")||o.data("association-insertion-position")||"before",l=o.data("association-insertion-node"),f=o.data("association-insertion-traversal"),p=parseInt(o.data("count"),10),u=new RegExp("\\[new_"+r+"\\](.*?\\s)","g"),g=new RegExp("_new_"+r+"_(\\w*)","g"),v=n(),m=c.replace(u,a(v)),h=[];for(m==c&&(u=new RegExp("\\[new_"+s+"\\](.*?\\s)","g"),g=new RegExp("_new_"+s+"_(\\w*)","g"),m=c.replace(u,a(v))),m=m.replace(g,i(v)),h=[m],p=isNaN(p)?1:Math.max(p,1),p-=1;p;)v=n(),m=c.replace(u,a(v)),m=m.replace(g,i(v)),h.push(m),p-=1;l=l?f?o[f](l):"this"==l?o:e(l):o.parent(),e.each(h,function(t,n){var a=e(n);l.trigger("cocoon:before-insert",[a]);l[d](a);l.trigger("cocoon:after-insert",[a])})}),e(document).on("click",".remove_fields.dynamic, .remove_fields.existing",function(t){var n=e(this),a=n.data("wrapper-class")||"nested-fields",i=n.closest("."+a),o=i.parent();t.preventDefault(),o.trigger("cocoon:before-remove",[i]);var r=o.data("remove-timeout")||0;setTimeout(function(){n.hasClass("dynamic")?i.remove():(n.prev("input[type=hidden]").val("1"),i.hide()),o.trigger("cocoon:after-remove",[i])},r)}),e(".remove_fields.existing.destroyed").each(function(){var t=e(this),n=t.data("wrapper-class")||"nested-fields";t.closest("."+n).hide()})}(jQuery),function(){}.call(this);